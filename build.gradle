plugins {
    id 'java'
    id 'idea'
    id "com.moowork.node" version "1.1.1"
    id "com.wiredforcode.spawn" version "0.8.2"
}

node {
    version = '0.11.10'
    npmVersion = '2.1.5'
}

repositories {
    jcenter()
}

dependencies {
    compile 'com.amazonaws:amazon-kinesis-client:1.7.5'
}

task installDynalite(type: NpmTask) {
  args = ['install', '-g', 'dynalite']
}

task startDynalite(type: SpawnProcessTask, group: 'DynamoDB', dependsOn: 'installDynalite') {
	command 'dynalite --port 7000'
    pidLockFileName '.dynalite.pid.lock'
	ready 'Listening at http'
}

task stopDynalite(type: KillProcessTask, group: 'DynamoDB') {
    description 'Stops background server process'
    pidLockFileName '.dynalite.pid.lock'
}

task installKinesalite(type: NpmTask) {
    args = ['install', '-g', 'kinesalite']
}

task startKinesalite(type: SpawnProcessTask, dependsOn: 'installKinesalite', group: 'Kinesis') {
	command 'kinesalite --port 7001'
    pidLockFileName '.kinesalite.pid.lock'
	ready 'Listening at http'
}

task stopKinesalite(type: KillProcessTask, group: 'Kinesis') {
    description 'Stops background server process'
    pidLockFileName '.kinesalite.pid.lock'
}
